<div class="escalation-admin-container">
  <!-- Encabezado -->
  <mat-card class="header-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>admin_panel_settings</mat-icon>
        Administración de Escalaciones
      </mat-card-title>
      <mat-card-subtitle>
        Gestión de clientes, servicios, contactos, reglas y turnos
      </mat-card-subtitle>
    </mat-card-header>
  </mat-card>

  <!-- Tabs -->
  <mat-tab-group [(selectedIndex)]="selectedTab" animationDuration="200ms">
    
    <!-- TAB 1: CLIENTES -->
    <mat-tab label="Clientes">
      <div class="tab-content">
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addClient()">
            <mat-icon>add</mat-icon>
            Agregar Cliente
          </button>
        </div>

        <!-- Formulario inline para agregar/editar cliente -->
        <mat-card *ngIf="showClientForm" class="form-card">
          <mat-card-header>
            <mat-card-title>{{ editingClientId ? 'Editar' : 'Nuevo' }} Cliente</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="clientForm" (ngSubmit)="saveClient()">
              <div class="form-row">
                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Nombre del Cliente</mat-label>
                  <input matInput formControlName="name" required placeholder="Ej: ACME, Global Tech">
                  <mat-error *ngIf="clientForm.get('name')?.hasError('required')">
                    El nombre es requerido
                  </mat-error>
                </mat-form-field>

                <mat-checkbox formControlName="active" class="form-field">Activo</mat-checkbox>
              </div>

              <div class="form-actions">
                <button mat-raised-button color="primary" type="submit" [disabled]="clientForm.invalid">
                  <mat-icon>save</mat-icon>
                  Guardar
                </button>
                <button mat-button type="button" (click)="cancelClientForm()">
                  Cancelar
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>

        <div *ngIf="loadingClients" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingClients && clients.length > 0" class="table-container">
          <table mat-table [dataSource]="clients" class="data-table">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Cliente</th>
              <td mat-cell *matCellDef="let row">{{ row.name }}</td>
            </ng-container>

            <ng-container matColumnDef="active">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip [color]="row.active ? 'primary' : ''">
                  {{ row.active ? 'Activo' : 'Inactivo' }}
                </mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editClient(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteClient(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="clientColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: clientColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingClients && clients.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay clientes registrados</p>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 2: SERVICIOS -->
    <mat-tab label="Servicios">
      <div class="tab-content">
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addService()">
            <mat-icon>add</mat-icon>
            Agregar Servicio
          </button>
        </div>

        <!-- Formulario inline para agregar/editar servicio -->
        <mat-card *ngIf="showServiceForm" class="form-card">
          <mat-card-header>
            <mat-card-title>{{ editingServiceId ? 'Editar' : 'Nuevo' }} Servicio</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="serviceForm" (ngSubmit)="saveService()">
              <div class="form-row">
                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Nombre del Servicio</mat-label>
                  <input matInput formControlName="name" required placeholder="Ej: ACME - Service A">
                  <mat-error *ngIf="serviceForm.get('name')?.hasError('required')">
                    El nombre es requerido
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Cliente</mat-label>
                  <mat-select formControlName="clientId" required>
                    <mat-option *ngFor="let client of clients" [value]="client._id">
                      {{ client.name }}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="serviceForm.get('clientId')?.hasError('required')">
                    Seleccione un cliente
                  </mat-error>
                </mat-form-field>

                <mat-checkbox formControlName="active" class="form-field">Activo</mat-checkbox>
              </div>

              <div class="form-actions">
                <button mat-raised-button color="primary" type="submit" [disabled]="serviceForm.invalid">
                  <mat-icon>save</mat-icon>
                  Guardar
                </button>
                <button mat-button type="button" (click)="cancelServiceForm()">
                  Cancelar
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>

        <div *ngIf="loadingServices" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingServices && services.length > 0" class="table-container">
          <table mat-table [dataSource]="services" class="data-table">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Servicio</th>
              <td mat-cell *matCellDef="let row">{{ row.name }}</td>
            </ng-container>

            <ng-container matColumnDef="clientName">
              <th mat-header-cell *matHeaderCellDef>Cliente</th>
              <td mat-cell *matCellDef="let row">{{ row.clientId?.name || 'N/A' }}</td>
            </ng-container>

            <ng-container matColumnDef="active">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip [color]="row.active ? 'primary' : ''">
                  {{ row.active ? 'Activo' : 'Inactivo' }}
                </mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editService(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteService(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="serviceColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: serviceColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingServices && services.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay servicios registrados</p>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 3: CONTACTOS -->
    <mat-tab label="Contactos">
      <div class="tab-content">
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addContact()">
            <mat-icon>add</mat-icon>
            Agregar Contacto
          </button>
        </div>

        <!-- Formulario inline para agregar/editar contacto -->
        <mat-card *ngIf="showContactForm" class="form-card">
          <mat-card-header>
            <mat-card-title>{{ editingContactId ? 'Editar' : 'Nuevo' }} Contacto</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <form [formGroup]="contactForm" (ngSubmit)="saveContact()">
              <div class="form-row">
                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Nombre</mat-label>
                  <input matInput formControlName="name" required>
                  <mat-error *ngIf="contactForm.get('name')?.hasError('required')">
                    El nombre es requerido
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Email</mat-label>
                  <input matInput type="email" formControlName="email" required>
                  <mat-error *ngIf="contactForm.get('email')?.hasError('required')">
                    El email es requerido
                  </mat-error>
                  <mat-error *ngIf="contactForm.get('email')?.hasError('email')">
                    Email inválido
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Teléfono</mat-label>
                  <input matInput formControlName="phone">
                </mat-form-field>

                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Organización</mat-label>
                  <input matInput formControlName="organization">
                </mat-form-field>

                <mat-checkbox formControlName="active" class="form-field">Activo</mat-checkbox>
              </div>

              <div class="form-actions">
                <button mat-raised-button color="primary" type="submit" [disabled]="contactForm.invalid">
                  <mat-icon>save</mat-icon>
                  Guardar
                </button>
                <button mat-button type="button" (click)="cancelContactForm()">
                  Cancelar
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>

        <div *ngIf="loadingContacts" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingContacts && contacts.length > 0" class="table-container">
          <table mat-table [dataSource]="contacts" class="data-table">
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef>Nombre</th>
              <td mat-cell *matCellDef="let row">{{ row.name }}</td>
            </ng-container>

            <ng-container matColumnDef="email">
              <th mat-header-cell *matHeaderCellDef>Email</th>
              <td mat-cell *matCellDef="let row">{{ row.email || '-' }}</td>
            </ng-container>

            <ng-container matColumnDef="phone">
              <th mat-header-cell *matHeaderCellDef>Teléfono</th>
              <td mat-cell *matCellDef="let row">{{ row.phone || '-' }}</td>
            </ng-container>

            <ng-container matColumnDef="organization">
              <th mat-header-cell *matHeaderCellDef>Organización</th>
              <td mat-cell *matCellDef="let row">{{ row.organization || '-' }}</td>
            </ng-container>

            <ng-container matColumnDef="active">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip [color]="row.active ? 'primary' : ''">
                  {{ row.active ? 'Activo' : 'Inactivo' }}
                </mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editContact(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteContact(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="contactColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: contactColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingContacts && contacts.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay contactos registrados</p>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 4: REGLAS DE ESCALACIÓN -->
    <mat-tab label="Reglas de Escalación">
      <div class="tab-content">
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addRule()">
            <mat-icon>add</mat-icon>
            Agregar Regla
          </button>
        </div>

        <div *ngIf="loadingRules" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingRules && rules.length > 0" class="table-container">
          <table mat-table [dataSource]="rules" class="data-table">
            <ng-container matColumnDef="primaryName">
              <th mat-header-cell *matHeaderCellDef>Nombre</th>
              <td mat-cell *matCellDef="let row">{{ getPrimaryRecipientName(row) }}</td>
            </ng-container>

            <ng-container matColumnDef="recipientsTo">
              <th mat-header-cell *matHeaderCellDef>Para</th>
              <td mat-cell *matCellDef="let row"
                  (click)="copyToClipboard(getRecipientEmails(row.recipientsTo))"
                  style="cursor: pointer; font-weight: 600;">
                {{ getRecipientEmails(row.recipientsTo) }}
              </td>
            </ng-container>

            <ng-container matColumnDef="recipientsCC">
              <th mat-header-cell *matHeaderCellDef>CC</th>
              <td mat-cell *matCellDef="let row"
                  (click)="copyToClipboard(getRecipientEmails(row.recipientsCC))"
                  style="cursor: pointer; font-weight: 600;">
                {{ getRecipientEmails(row.recipientsCC) }}
              </td>
            </ng-container>

            <ng-container matColumnDef="emergencyPhone">
              <th mat-header-cell *matHeaderCellDef>Teléfono</th>
              <td mat-cell *matCellDef="let row" style="color: #c0392b; font-weight: 700;">
                {{ row.emergencyPhone || '-' }}
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editRule(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteRule(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="ruleColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: ruleColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingRules && rules.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay reglas de escalación registradas</p>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 5: TURNOS (Assignments + Overrides) -->
    <mat-tab label="Turnos">
      <div class="tab-content">
        <!-- Asignaciones -->
        <h2>Asignaciones Regulares</h2>
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addAssignment()">
            <mat-icon>add</mat-icon>
            Agregar Asignación
          </button>
        </div>

        <div *ngIf="loadingAssignments" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingAssignments && assignments.length > 0" class="table-container">
          <table mat-table [dataSource]="assignments" class="data-table">
            <ng-container matColumnDef="roleCode">
              <th mat-header-cell *matHeaderCellDef>Rol</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip color="primary">{{ row.roleCode }}</mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="userName">
              <th mat-header-cell *matHeaderCellDef>Usuario</th>
              <td mat-cell *matCellDef="let row">{{ row.userId?.name || 'N/A' }}</td>
            </ng-container>

            <ng-container matColumnDef="weekStartDate">
              <th mat-header-cell *matHeaderCellDef>Inicio</th>
              <td mat-cell *matCellDef="let row">{{ formatDateTime(row.weekStartDate) }}</td>
            </ng-container>

            <ng-container matColumnDef="weekEndDate">
              <th mat-header-cell *matHeaderCellDef>Fin</th>
              <td mat-cell *matCellDef="let row">{{ formatDateTime(row.weekEndDate) }}</td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editAssignment(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteAssignment(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="assignmentColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: assignmentColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingAssignments && assignments.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay asignaciones registradas</p>
        </div>

        <mat-divider style="margin: 32px 0;"></mat-divider>

        <!-- Overrides -->
        <h2>Reemplazos Temporales (Overrides)</h2>
        <div class="tab-header">
          <button mat-raised-button color="accent" (click)="addOverride()">
            <mat-icon>add</mat-icon>
            Agregar Override
          </button>
        </div>

        <!-- Formulario de Override -->
        <mat-card *ngIf="showOverrideForm" class="form-card">
          <form [formGroup]="overrideForm" (ngSubmit)="saveOverride()">
            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Rol</mat-label>
                <mat-select formControlName="roleCode" required>
                  <mat-option *ngFor="let role of shiftRoles" [value]="role">
                    {{ role }}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="overrideForm.get('roleCode')?.hasError('required')">
                  El rol es requerido
                </mat-error>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Usuario de Reemplazo</mat-label>
                <mat-select formControlName="replacementUserId" required>
                  <mat-option *ngFor="let user of users" [value]="user._id">
                    {{ user.name }}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="overrideForm.get('replacementUserId')?.hasError('required')">
                  El usuario es requerido
                </mat-error>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" style="flex: 1; margin-right: 16px;">
                <mat-label>Fecha y Hora Inicio</mat-label>
                <input matInput type="datetime-local" formControlName="startDate" required>
                <mat-error *ngIf="overrideForm.get('startDate')?.hasError('required')">
                  La fecha de inicio es requerida
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" style="flex: 1;">
                <mat-label>Fecha y Hora Fin</mat-label>
                <input matInput type="datetime-local" formControlName="endDate" required>
                <mat-error *ngIf="overrideForm.get('endDate')?.hasError('required')">
                  La fecha de fin es requerida
                </mat-error>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Motivo del Reemplazo</mat-label>
                <textarea matInput formControlName="reason" rows="3" 
                          placeholder="Ej: Vacaciones, Licencia médica, Permiso especial" required></textarea>
                <mat-error *ngIf="overrideForm.get('reason')?.hasError('required')">
                  El motivo es requerido
                </mat-error>
              </mat-form-field>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="active">Activo</mat-checkbox>
            </div>

            <div class="form-actions">
              <button mat-raised-button color="primary" type="submit" [disabled]="!overrideForm.valid || savingOverride">
                <mat-icon>save</mat-icon>
                {{ editingOverrideId ? 'Actualizar' : 'Guardar' }}
              </button>
              <button mat-button type="button" (click)="cancelOverrideForm()">
                Cancelar
              </button>
            </div>
          </form>
        </mat-card>

        <div *ngIf="loadingOverrides" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingOverrides && overrides.length > 0" class="table-container">
          <table mat-table [dataSource]="overrides" class="data-table">
            <ng-container matColumnDef="roleCode">
              <th mat-header-cell *matHeaderCellDef>Rol</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip color="accent">{{ row.roleCode }}</mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="replacementUserName">
              <th mat-header-cell *matHeaderCellDef>Reemplazo</th>
              <td mat-cell *matCellDef="let row">
                {{ (row.replacementUserId?.name || row.replacementUserName || 'N/A') }}
              </td>
            </ng-container>

            <ng-container matColumnDef="startDate">
              <th mat-header-cell *matHeaderCellDef>Inicio</th>
              <td mat-cell *matCellDef="let row">{{ formatDateTime(row.startDate) }}</td>
            </ng-container>

            <ng-container matColumnDef="endDate">
              <th mat-header-cell *matHeaderCellDef>Fin</th>
              <td mat-cell *matCellDef="let row">{{ formatDateTime(row.endDate) }}</td>
            </ng-container>

            <ng-container matColumnDef="reason">
              <th mat-header-cell *matHeaderCellDef>Motivo</th>
              <td mat-cell *matCellDef="let row">{{ row.reason }}</td>
            </ng-container>

            <ng-container matColumnDef="active">
              <th mat-header-cell *matHeaderCellDef>Estado</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip [color]="row.active ? 'warn' : ''">
                  {{ row.active ? 'Activo' : 'Inactivo' }}
                </mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editOverride(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteOverride(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="overrideColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: overrideColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingOverrides && overrides.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay overrides registrados</p>
        </div>
      </div>
    </mat-tab>

    <!-- TAB 6: CICLOS DE ROTACIÓN -->
    <mat-tab label="Ciclos de Rotación">
      <div class="tab-content">
        <div class="tab-header">
          <button mat-raised-button color="primary" (click)="addCycle()">
            <mat-icon>add</mat-icon>
            Agregar Ciclo
          </button>
        </div>

        <div *ngIf="loadingCycles" class="loading-container">
          <mat-spinner></mat-spinner>
        </div>

        <div *ngIf="!loadingCycles && cycles.length > 0" class="table-container">
          <table mat-table [dataSource]="cycles" class="data-table">
            <ng-container matColumnDef="roleCode">
              <th mat-header-cell *matHeaderCellDef>Rol</th>
              <td mat-cell *matCellDef="let row">
                <mat-chip color="primary">{{ row.roleCode }}</mat-chip>
              </td>
            </ng-container>

            <ng-container matColumnDef="startDayOfWeek">
              <th mat-header-cell *matHeaderCellDef>Día Inicio</th>
              <td mat-cell *matCellDef="let row">{{ getDayName(row.startDayOfWeek) }}</td>
            </ng-container>

            <ng-container matColumnDef="startTimeUTC">
              <th mat-header-cell *matHeaderCellDef>Hora UTC</th>
              <td mat-cell *matCellDef="let row">{{ row.startTimeUTC }}</td>
            </ng-container>

            <ng-container matColumnDef="durationDays">
              <th mat-header-cell *matHeaderCellDef>Duración (días)</th>
              <td mat-cell *matCellDef="let row">{{ row.durationDays }}</td>
            </ng-container>

            <ng-container matColumnDef="timezone">
              <th mat-header-cell *matHeaderCellDef>Zona Horaria</th>
              <td mat-cell *matCellDef="let row">{{ row.timezone }}</td>
            </ng-container>

            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let row">
                <button mat-icon-button color="primary" (click)="editCycle(row)" matTooltip="Editar">
                  <mat-icon>edit</mat-icon>
                </button>
                <button mat-icon-button color="warn" (click)="deleteCycle(row._id)" matTooltip="Eliminar">
                  <mat-icon>delete</mat-icon>
                </button>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="cycleColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: cycleColumns;"></tr>
          </table>
        </div>

        <div *ngIf="!loadingCycles && cycles.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>No hay ciclos de rotación registrados</p>
        </div>
      </div>
    </mat-tab>

  </mat-tab-group>
</div>
