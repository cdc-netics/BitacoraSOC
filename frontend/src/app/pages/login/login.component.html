<div class="crt-container">
  <!-- Background grid -->
  <div class="crt-grid"></div>
  
  <!-- Scanlines overlay -->
  <div class="crt-scanlines"></div>

  <!-- Main content -->
  <div class="crt-content">
    <!-- Banner -->
    <div *ngIf="showBanner" [class]="'banner banner-' + bannerType">
      <div class="banner-text">{{ bannerMessage }}</div>
      <div class="banner-secondary" *ngIf="bannerType === 'success'">
        IF THE ACCOUNT EXISTS, EMAIL WILL ARRIVE
      </div>
    </div>

    <!-- Login Panel -->
    <div class="login-panel" [class.hidden]="currentView === 'recovery'">
      <div class="panel-header">
        <div class="header-line"></div>
        <h1 class="panel-title">BITÁCORA</h1>
        <div class="header-line"></div>
      </div>

      <form [formGroup]="loginForm" (ngSubmit)="onLoginSubmit()" class="crt-form">
        <!-- Username field -->
        <div class="form-group">
          <label for="username" class="form-label">USERNAME:</label>
          <div class="input-wrapper">
            <input
              id="username"
              type="text"
              formControlName="username"
              class="crt-input"
              autocomplete="username"
              [disabled]="loading"
              placeholder="Enter username"
            />
            <span class="input-glow"></span>
          </div>
          <div class="error-messages">
            <div *ngIf="loginForm.get('username')?.hasError('required') && loginForm.get('username')?.touched" class="error-text">
              USERNAME REQUIRED
            </div>
            <div *ngIf="loginForm.get('username')?.hasError('minlength') && loginForm.get('username')?.touched" class="error-text">
              MINIMUM 3 CHARACTERS
            </div>
          </div>
        </div>

        <!-- Password field -->
        <div class="form-group">
          <label for="password" class="form-label">PASSWORD:</label>
          <div class="input-wrapper">
            <input
              id="password"
              [type]="hidePassword ? 'password' : 'text'"
              formControlName="password"
              class="crt-input"
              autocomplete="current-password"
              [disabled]="loading"
              placeholder="Enter password"
            />
            <button
              type="button"
              class="visibility-toggle"
              (click)="hidePassword = !hidePassword"
              [disabled]="loading"
              tabindex="-1"
            >
              {{ hidePassword ? '[SHOW]' : '[HIDE]' }}
            </button>
            <span class="input-glow"></span>
          </div>
          <div class="error-messages">
            <div *ngIf="loginForm.get('password')?.hasError('required') && loginForm.get('password')?.touched" class="error-text">
              PASSWORD REQUIRED
            </div>
            <div *ngIf="loginForm.get('password')?.hasError('minlength') && loginForm.get('password')?.touched" class="error-text">
              MINIMUM 6 CHARACTERS
            </div>
          </div>
        </div>

        <!-- Submit button -->
        <button
          type="submit"
          class="crt-button"
          [disabled]="loading || loginForm.invalid"
          [class.loading]="loading"
        >
          <span *ngIf="!loading">[ LOGIN ]</span>
          <span *ngIf="loading" class="pulse">[ AUTHENTICATING... ]</span>
        </button>
        
        <!-- Session info -->
        <div class="session-info">
          ⏰ SESSION EXPIRES: ADMIN/USER 4H | GUEST 2H
        </div>
      </form>

      <!-- Recovery link -->
      <button
        type="button"
        class="recover-link"
        (click)="switchToRecovery()"
        [disabled]="loading"
      >
        RECOVER PASSWORD
      </button>

      <!-- Footer -->
      <div class="panel-footer">
        <div class="footer-text">BITÁCORA SOC v{{ appVersion }}</div>
      </div>
    </div>

    <!-- Recovery Panel -->
    <div class="recovery-panel" [class.hidden]="currentView === 'login'">
      <div class="panel-header">
        <div class="header-line"></div>
        <h1 class="panel-title">PASSWORD RECOVERY</h1>
        <div class="header-line"></div>
      </div>

      <form [formGroup]="recoveryForm" (ngSubmit)="onRecoverySubmit()" class="crt-form">
        <!-- Email field -->
        <div class="form-group">
          <label for="email" class="form-label">EMAIL:</label>
          <div class="input-wrapper">
            <input
              id="email"
              type="email"
              formControlName="email"
              class="crt-input"
              [disabled]="loading"
              placeholder="Enter your email"
            />
            <span class="input-glow"></span>
          </div>
          <div class="error-messages">
            <div *ngIf="recoveryForm.get('email')?.hasError('required') && recoveryForm.get('email')?.touched" class="error-text">
              EMAIL REQUIRED
            </div>
            <div *ngIf="recoveryForm.get('email')?.hasError('email') && recoveryForm.get('email')?.touched" class="error-text">
              INVALID FORMAT
            </div>
          </div>
        </div>

        <!-- Submit button -->
        <button
          type="submit"
          class="crt-button"
          [disabled]="loading || recoveryForm.invalid"
          [class.loading]="loading"
        >
          <span *ngIf="!loading">[ SEND RECOVERY LINK ]</span>
          <span *ngIf="loading" class="pulse">[ SENDING REQUEST... ]</span>
        </button>
      </form>

      <!-- Back to login link -->
      <button
        type="button"
        class="recover-link"
        (click)="switchToLogin()"
        [disabled]="loading"
      >
        BACK TO LOGIN
      </button>

      <!-- Footer -->
      <div class="panel-footer">
        <div class="footer-text">SECURE PASSWORD RECOVERY</div>
        <div class="footer-text small">DO NOT DISCLOSE ACCOUNT STATUS</div>
      </div>
    </div>
  </div>
</div>
