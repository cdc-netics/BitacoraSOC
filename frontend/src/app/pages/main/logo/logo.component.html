<div class="logo-container">
  <h1>游꿛 Branding</h1>
  <p class="subtitle">Personaliza el branding de la aplicaci칩n</p>

  <div class="logo-grid">
    <!-- Logo actual -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>Logo Actual</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="logo-preview">
          <img *ngIf="currentLogo" [src]="getAssetUrl(currentLogo)" alt="Logo actual">
          <div *ngIf="!currentLogo" class="no-logo">
            <mat-icon>image</mat-icon>
            <p>Sin logo configurado</p>
          </div>
        </div>
        <button mat-stroked-button color="warn" (click)="removeLogo()" *ngIf="currentLogo" [disabled]="isLoading">
          <mat-icon>delete</mat-icon>
          Eliminar Logo
        </button>
      </mat-card-content>
    </mat-card>

    <!-- Favicon actual -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>Favicon Actual</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="logo-preview favicon-preview">
          <img *ngIf="currentFavicon" [src]="getAssetUrl(currentFavicon)" alt="Favicon actual">
          <div *ngIf="!currentFavicon" class="no-logo">
            <mat-icon>tab</mat-icon>
            <p>Sin favicon configurado</p>
          </div>
        </div>
        <button mat-stroked-button color="warn" (click)="removeFavicon()" *ngIf="currentFavicon" [disabled]="isLoading">
          <mat-icon>delete</mat-icon>
          Eliminar Favicon
        </button>
      </mat-card-content>
    </mat-card>

    <!-- Subir archivo -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>Subir Imagen</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <input type="file" 
               #fileInput 
               (change)="onFileSelected($event)" 
               accept="image/png,image/jpeg,image/svg+xml"
               style="display: none">
        
        <div class="upload-zone" (click)="fileInput.click()">
          <img *ngIf="previewUrl" [src]="previewUrl" alt="Preview">
          <div *ngIf="!previewUrl" class="upload-placeholder">
            <mat-icon>cloud_upload</mat-icon>
            <p>Click para seleccionar imagen</p>
            <small>PNG, JPG o SVG (m치x 2MB)</small>
          </div>
        </div>
        
        <button mat-raised-button color="primary" (click)="uploadLogo()" [disabled]="!previewUrl || isLoading">
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          <span *ngIf="!isLoading">Subir Logo</span>
        </button>
      </mat-card-content>
    </mat-card>

    <!-- URL externa -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>URL Externa</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>URL del Logo</mat-label>
          <input matInput [(ngModel)]="logoUrl" placeholder="https://ejemplo.com/logo.png">
          <mat-hint>Ingresa la URL directa de una imagen</mat-hint>
        </mat-form-field>
        
        <button mat-raised-button color="accent" (click)="saveLogo()" [disabled]="!logoUrl || isLoading">
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          <span *ngIf="!isLoading">Guardar URL</span>
        </button>
      </mat-card-content>
    </mat-card>

    <!-- Favicon -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>Favicon (PNG/ICO)</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <input type="file"
               #faviconInput
               (change)="onFaviconFileSelected($event)"
               accept="image/png,image/x-icon,.ico"
               style="display: none">

        <div class="upload-zone favicon-preview" (click)="faviconInput.click()">
          <img *ngIf="faviconPreviewUrl" [src]="faviconPreviewUrl" alt="Preview favicon">
          <div *ngIf="!faviconPreviewUrl" class="upload-placeholder">
            <mat-icon>insert_photo</mat-icon>
            <p>Click para seleccionar favicon</p>
            <small>PNG o ICO (m치x 256KB, ideal 32x32)</small>
          </div>
        </div>

        <button mat-raised-button color="primary" (click)="uploadFavicon()" [disabled]="!faviconPreviewUrl || isLoading">
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          <span *ngIf="!isLoading">Subir Favicon</span>
        </button>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>URL del Favicon</mat-label>
          <input matInput [(ngModel)]="faviconUrl" placeholder="https://ejemplo.com/favicon.ico">
          <mat-hint>Usa una imagen peque침a y cuadrada (32x32 o 64x64)</mat-hint>
        </mat-form-field>

        <button mat-raised-button color="accent" (click)="saveFavicon()" [disabled]="!faviconUrl || isLoading">
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          <span *ngIf="!isLoading">Guardar URL Favicon</span>
        </button>
      </mat-card-content>
    </mat-card>

    <!-- LogSource por Defecto -->
    <mat-card class="logo-card">
      <mat-card-header>
        <mat-card-title>Configuraci칩n por Defecto</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <form [formGroup]="brandingForm" (ngSubmit)="saveBrandingConfig()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>LogSource por Defecto</mat-label>
            <mat-select formControlName="defaultLogSourceId">
              <mat-option [value]="null">-- Sin LogSource predeterminado --</mat-option>
              <mat-option *ngFor="let source of logSources" [value]="source._id">
                {{ source.name }}{{ source.parent ? ' (' + source.parent + ')' : '' }}
              </mat-option>
            </mat-select>
            <mat-hint>Se asignar치 autom치ticamente al crear entradas sin seleccionar cliente</mat-hint>
          </mat-form-field>

          <button mat-raised-button color="primary" type="submit"
                  [disabled]="!brandingForm.valid || savingBranding">
            <mat-spinner *ngIf="savingBranding" diameter="18"></mat-spinner>
            <span *ngIf="!savingBranding">Guardar Configuraci칩n</span>
          </button>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
